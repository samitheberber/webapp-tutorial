<!DOCTYPE html>
<html>
    <head>
        <title>Web Application Tutorial</title>
    </head>
    <body>
        <h1>Web Application Tutorial</h1>

        <p>This tutorial shows how to create web application with sinatra. The tutorial expects that Git is in use.</p>


        <h2>Table of Content</h2>

        <ol>
            <li><a href="#ruby_rvm_bundler">Ruby, RVM and bundler</a></li>
            <li><a href="#creating_new_sinatra_project">Creating new project with sinatra</a></li>
            <li><a href="#handling_responses">Handling responses</a></li>
            <li><a href="#creating_erbviews">Creating erb-views</a></li>
            <li><a href="#using_classes">Using classes</a></li>
            <li><a href="#adding_database">Adding database</a></li>
            <li><a href="#sessions">Sessions</a></li>
            <li><a href="#heroku_deployment">Heroku deployment</a></li>
        </ol>


        <h2 id="ruby_rvm_bundler">Ruby, RVM and bundler</h2>

        <p>In my course we are using Ruby 1.8.7, RVM and bundler. I try to tell the role of each tools in this chapter.</p>

        <h3>Installing ruby for Windows</h3>

        <p>Tools for Windows aren't so great as they are in Unix world, but you can manage with them. All you need is <a href="http://rubyinstaller.org/">RubyInstaller</a>. If you want use many versions of ruby, you can try <a href="https://github.com/vertiginous/pik">pik</a>.

        <h3>Installing ruby for Unix (the RVM way)</h3>

        <p><a href="https://rvm.beginrescueend.com/">RVM</a> (Ruby Version Manager) is one of the must-have tools in ruby world. It installs all ruby versions you want, manages gem sets and lots of more.</p>

        <p>At first you need to open your terminal and paste this: <code>bash < <(curl -s https://rvm.beginrescueend.com/install/rvm)</code></p>

        <p>I assume that you are using bash, so you can command <code>echo '[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # Load RVM function' >> ~/.bash_profile</code> and now you have rvm running on next terminal session. To verify this, close current terminal session and open new. After that command <code>rvm -v</code> and you will see rvm version information, if all went fine.</p>

        <p>When we have RVM, it is time to manage ruby versions. Lets install ruby 1.8.7: <code>rvm install 1.8.7</code> Now the latest patch ruby version 1.8.7 is compiling and installing. When this is done, you can use it with <code>rvm use 1.8.7</code>, but you don't want to command this every time you open new terminal, so lets make it default ruby with <code>rvm use 1.8.7 --default</code></p>

        <p>Lets verify that we have RVM installed ruby. <code>gem env</code> the command output should specify paths so that they point under the .rvm-directory in your home.</p>

        <h3>Installing bundler to manage your gems</h3>

        <p>In Windows just <code>gem install bundler</code> (pik doesn't have gem sets).</p>

        <p>In Unix you want to install bundler so that all your projects can access to it, so lets make it in global gemset. First make global gemset in use: <code>rvm gemset use global</code> (verify this with <code>gem env</code> so that all there should be only one line under GEM PATHS and is should end @global). Now install bundler with <code>gem install bundler</code> You can clear used gemset to default, but not necessary: <code>rvm gemset clear</code></p>

        <p>This should be the last time you use <code>gem install <name of gem></code> If not so, you should re-think, what you are doing.</p>


        <h2 id="creating_new_sinatra_project">Creating new project with sinatra</h2>

        <p>Before this, I have created new repository in github and followed instruction from there. My stage is that I have empty README-file with initial commit.</p>

        <h3>Setting up RVM for this project</h3>

        <p>At first I want to add .rvmrc file with my project gemset. webapp-tutorial/.rvmrc looks like this: <code>rvm use 1.8.7@webapp-tutorial</code> (In windows, make just this and skip following. By doing this, you are kind to Unix users)</p>

        <p>When I enter my webapp-tutorial directory, RVM asks me if I want to add currently found .rvmrc-file in trusted files and that's what I want to do (answer yes). Without any customizing, RVM should tell you to create used gemset, so lets create one: <code>rvm gemset create webapp-tutorial</code> Re-enter after this.</p>

        <p>If everything went fine, <code>gem env</code> should show you two lines in GEM PATHS, one ending webapp-tutorial and another one ending global.</p>

        <h3>Setting project bundler</h3>

        <p>Just command: <code>bundle init</code> Now you should have Gemfile called file in your working directory.</p>

        <p>You can always check if your gems are fine with <code>bundle check</code> It will tell what to do, if they aren't fine (mostly tells to install them). Now you should have Gemfile.lock, which contains information about your gems.</p>

        <p>You can install gems with bundler by commanding <code>bundle install</code></p>

        <h3>Lets install sinatra</h3>

        <p>Just add <code>gem 'sinatra'</code> in your Gemfile and run <code>bundle install</code></p>

        <h3>Create first sinatra application with hello world response</h3>

        <p>Create my_sinatra_app.rb which constains following code:</p>
        <pre>require 'rubygems'
require 'sinatra'

get '/' do
  "Hello world"
end</pre>

        <p>For easy server use, you should have config.ru:</p>
        <pre>require './my_sinatra_app'

run Sinatra::Application</pre>

        <p>Last think is to run your new born application: <code>rackup</code> and open your browser with url <a href="http://localhost:9292">http://localhost:9292</a> (9292 should be the default rack port, change it if rackup tells a different one)</p>


        <p class="gommit">Now is good time for a commit!</p>



        <h2 id="handling_responses">Handling responses</h2>

        <h2 id="creating_erbviews">Creating erb-views</h2>

        <h2 id="using_classes">Using classes</h2>

        <h2 id="adding_database">Adding database</h2>

        <h2 id="sessions">Sessions</h2>

        <h2 id="heroku_deployment">Heroku deployment</h2>

    </body>
</html>
